# 🚨 BoxLog Breaking Changes

このドキュメントは、BoxLogアプリケーションの破壊的変更（Breaking Changes）の記録です。
アップグレード時の影響評価とマイグレーション計画の参考にしてください。

## 📋 記録フォーマット

各破壊的変更には以下の情報を含めています：

- **変更内容**: 何が変更されたか
- **影響範囲**: 誰・何に影響するか
- **マイグレーション**: 対応方法・手順
- **理由**: なぜ変更が必要だったか
- **回避方法**: 可能な場合の代替手段

---

## 1.0.0 (2025-09-26) - 自動検知変更

### 🎨 Component Interface Change

**変更内容:**
UIコンポーネントインターフェースが変更されました

**影響範囲:**

- ✅ **開発者**: 影響あり

**ファイル:**
`src/features/notifications/components/NotificationModal.tsx`

**信頼度:** 60%

---

### 🎨 Component Interface Change

**変更内容:**
UIコンポーネントインターフェースが変更されました

**影響範囲:**

- ✅ **開発者**: 影響あり

**ファイル:**
`src/features/notifications/components/notifications-list.tsx`

**信頼度:** 60%

---

## v1.1.0 (2025-09-26) - 開発ベストプラクティス強化

### 🔧 設定ファイルスキーマの統一

**変更内容:**

- 設定ファイルの構造変更・Zodスキーマ導入
- 環境変数マッピングの変更

**影響範囲:**

- ✅ **開発者**: 設定ファイルの構造理解・更新が必要
- ✅ **DevOps**: 環境変数の見直し・CI/CD設定更新
- ❌ **エンドユーザー**: 影響なし

**マイグレーション:**

```bash
# 1. 新しい設定ファイル形式への移行
npm run config:validate  # 現在の設定をチェック
npm run config:compare   # 環境別設定の差分確認

# 2. 環境変数の更新（必要に応じて）
# DB_HOST → DATABASE_HOST
# JWT_SECRET → AUTH_JWT_SECRET
```

**理由:** 設定の型安全性向上・環境別管理の統一

---

### 📊 ログフォーマットの標準化

**変更内容:**

- ログ出力形式のJSON構造化
- メタデータフィールドの統一

**影響範囲:**

- ✅ **開発者**: ログ解析・デバッグ方法の変更
- ✅ **運用チーム**: ログ監視・アラート設定の更新
- ❌ **エンドユーザー**: 影響なし

**マイグレーション:**

```typescript
// Before (v1.0.x)
console.log('User logged in', userId, method)

// After (v1.1.0+)
import { logger } from '@/lib/logger'
logger.info('User logged in', { userId, method })

// ログ分析
npm run logs:analyze  # 新しい分析ツールを使用
```

**理由:** ログの構造化・分析効率向上・運用監視の強化

---

### 🔄 API バージョニング導入

**変更内容:**

- APIエンドポイントのバージョニング機能追加
- レスポンス形式の統一

**影響範囲:**

- ⚠️ **外部API利用者**: APIアクセス方法の変更
- ✅ **フロントエンド**: バージョン指定の対応
- ❌ **エンドユーザー**: 影響なし（互換性維持）

**マイグレーション:**

```javascript
// Before (v1.0.x)
fetch('/api/users')

// After (v1.1.0+) - 推奨
fetch('/api/v1/users')
// または
fetch('/api/users', {
  headers: { 'API-Version': '1.0' },
})
```

**理由:** API互換性管理・段階的アップグレード対応

---

## v1.0.0 (2025-01-01) - 初回リリース

### 🚀 BoxLog アプリケーション初回リリース

**変更内容:**

- BoxLog タスク管理アプリケーションの初回リリース
- Next.js 14 + TypeScript + Supabase構成

**影響範囲:**

- ✅ **全ユーザー**: 新機能の利用開始

**マイグレーション:**

- 初回リリースのため、マイグレーション不要
- セットアップ手順: `docs/README.md` を参照

---

## 📚 マイグレーションガイド

### v1.0.x → v1.1.0 アップグレード手順

1. **事前確認**

   ```bash
   # 現在の環境確認
   npm run config:validate
   npm run api:version:test
   ```

2. **依存関係更新**

   ```bash
   npm install  # 最新の依存関係をインストール
   ```

3. **設定ファイル更新**

   ```bash
   npm run config:compare  # 差分確認
   # 必要に応じて config/*.json を更新
   ```

4. **動作確認**

   ```bash
   npm run dev             # 開発サーバー起動
   npm run api:version:full # API動作確認
   npm run logs:analyze    # ログ出力確認
   ```

5. **本番デプロイ**
   ```bash
   npm run build           # プロダクションビルド
   # デプロイ後、動作確認を実施
   ```

---

## 🚨 アップグレード時の注意事項

### 高リスク変更

1. **設定ファイル構造変更** (v1.1.0)
   - 環境変数の確認・更新が必須
   - CI/CD設定の見直しが必要

2. **API バージョニング導入** (v1.1.0)
   - 外部連携システムの影響確認
   - フロントエンド側の対応

### 推奨手順

1. **段階的アップグレード**
   - 開発環境 → ステージング → 本番の順でアップグレード
   - 各段階で十分な動作確認を実施

2. **ロールバック計画**
   - データベースバックアップの取得
   - 前バージョンへの切り戻し手順の確認

3. **チーム連携**
   - 破壊的変更の事前共有
   - アップグレード作業の担当者明確化

---

## 📞 サポート

### アップグレードでお困りの場合

1. **ドキュメント確認**
   - [README.md](README.md) - セットアップ手順
   - [docs/](docs/) - 詳細ドキュメント

2. **自動診断**

   ```bash
   npm run config:full     # 設定診断
   npm run api:version:full # API診断
   npm run quality:full    # 品質チェック
   ```

3. **Issue報告**
   - [GitHub Issues](https://github.com/t3-nico/boxlog-app/issues)
   - 問題の詳細・環境情報を含めて報告

---

## 📋 変更記録テンプレート

新しい破壊的変更を記録する際は、以下のテンプレートを使用してください：

````markdown
## vX.Y.Z (YYYY-MM-DD) - 変更内容の概要

### 🎯 変更タイトル

**変更内容:**

- 具体的な変更点

**影響範囲:**

- ✅ **対象グループ**: 影響の詳細
- ❌ **対象外グループ**: 影響なし

**マイグレーション:**
\```bash

# 移行手順

\```

**理由:** 変更が必要だった理由

**回避方法:** （可能な場合）代替手段
````

---

**📝 最終更新**: 2025-09-26
**📋 記録担当**: Claude Code Development Team
