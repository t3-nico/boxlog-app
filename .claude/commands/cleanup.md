# 不要コード削除

不要なコード、ファイル、機能を安全に削除する。

## 検出対象

### 1. 未使用のexport

```bash
# 検出コマンド
npx knip --reporter=compact
```

### 2. 参照されていないファイル

- コンポーネントファイル（インポートされていない）
- ユーティリティ関数（呼び出されていない）
- 型定義ファイル（参照されていない）

### 3. デッドコード

- 到達不能なコードパス（`if (false)` 等）
- 使われていない変数・引数
- コメントアウトされたコード

### 4. 古いコメント

- `TODO` - 実装済みか確認
- `FIXME` - 修正済みか確認
- `HACK` - リファクタリング対象
- `@deprecated` - 削除可能か確認

### 5. 不要なファイル

- `.bak`, `.old`, `.tmp` ファイル
- 重複した型定義
- 空のindex.ts（re-exportのみ）

## 削除手順

1. **影響範囲の確認**
   - `grep -r "import.*対象" src/` で参照を検索
   - テストファイルへの影響を確認

2. **段階的な削除**
   - まずexportを削除（内部関数化）
   - `npm run typecheck` で参照エラーを確認
   - エラーがなければファイル全体を削除

3. **検証**
   - `npm run typecheck` - 型エラーがないか
   - `npm run lint` - Lintエラーがないか
   - 関連する画面が正常に動作するか

## なぜ削除するのか

不要なコードを残すデメリット：

- **認知負荷**: 「これは使われているのか？」と悩む
- **保守コスト**: 変更時に不要なコードも考慮が必要
- **バグのリスク**: 使われていないと思ったコードが実は使われていた

**YAGNI原則**: 「いつか使うかも」で残さない。必要になったらまた作る。

## 出力形式

```markdown
## 削除レポート

### 検出した不要コード

| ファイル             | 種別         | 理由     |
| -------------------- | ------------ | -------- |
| `path/to/file.ts`    | 未使用export | 参照0件  |
| `path/to/util.ts:42` | デッドコード | 到達不能 |

### 削除したファイル

- `path/to/file1.ts` - 理由
- `path/to/file2.ts` - 理由

### 削除したコード

- `functionName` in `file.ts` - 理由

### 検証結果

- typecheck: [パス/失敗]
- lint: [パス/失敗]
```

## 自動検出ツール

プロジェクトで利用可能なツール：

```bash
# ESLint未使用変数検出
npm run lint -- --rule 'no-unused-vars: error'

# TypeScript未使用エクスポート（knipがある場合）
npx knip

# 手動検索
grep -r "export.*function" src/ | wc -l  # export数
grep -roh "import.*from" src/ | sort | uniq -c | sort -rn  # import頻度
```
