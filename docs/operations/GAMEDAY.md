# BoxLog GameDay（障害訓練）ガイド

> 定期的な障害訓練を通じてインシデント対応能力を向上

## 概要

GameDayは、本番環境に影響を与えずに障害対応を訓練するための活動です。

**目的:**

- Runbookの有効性検証
- 対応時間の短縮
- チームの連携強化

## 訓練スケジュール

| 頻度   | 内容                 | 対象           |
| ------ | -------------------- | -------------- |
| 月次   | シナリオ訓練         | オンコール担当 |
| 四半期 | 大規模障害訓練       | 全チーム       |
| 半期   | 外部サービス障害訓練 | 全チーム       |

## 訓練シナリオ

### シナリオ1: API障害（難易度: 易）

**状況設定:**

```
09:00 - アラート発報
「/api/plans エンドポイントで500エラーが急増」
```

**期待される行動:**

1. アラート確認、Slack報告
2. Sentryでエラー詳細確認
3. 原因特定（例: DBクエリタイムアウト）
4. 復旧対応
5. 完了報告

**成功基準:**

- 検知から復旧まで30分以内
- 正確な原因特定
- Runbook手順に従った対応

### シナリオ2: 認証サービス障害（難易度: 中）

**状況設定:**

```
14:00 - ユーザー報告
「ログインができない」
Sentryで401エラー急増を確認
```

**期待される行動:**

1. 影響範囲の確認
2. Supabase Authステータス確認
3. 一時対応（メンテナンスページ表示）
4. 原因調査
5. 復旧または待機判断

**成功基準:**

- ユーザーへの告知15分以内
- 適切なエスカレーション判断

### シナリオ3: デプロイ失敗（難易度: 中）

**状況設定:**

```
16:30 - デプロイ直後
「サービス全体で500エラー」
```

**期待される行動:**

1. 直前デプロイの特定
2. ロールバック実行
3. 原因調査
4. 修正PR作成

**成功基準:**

- ロールバック10分以内
- 再発防止策の提案

### シナリオ4: 大量トラフィック（難易度: 難）

**状況設定:**

```
12:00 - メディア掲載
「アクセス数が通常の10倍に急増」
「レスポンスタイムが悪化」
```

**期待される行動:**

1. パフォーマンス状況確認
2. スケーリング対応
3. キャッシュ設定確認
4. 必要に応じてレート制限

**成功基準:**

- サービス継続性の維持
- 適切なスケーリング判断

## 訓練の実施方法

### 事前準備

1. **シナリオ選択**: 上記から選択または新規作成
2. **役割分担**:
   - ファシリテーター: 訓練進行
   - 参加者: 実際に対応
   - 観察者: フィードバック担当
3. **環境準備**: Staging環境で実施

### 訓練中

```
1. ファシリテーターがシナリオを発表
2. 参加者は通常のインシデント対応を実施
3. 観察者は対応をログに記録
4. 終了後、全員で振り返り
```

### 振り返りテンプレート

```markdown
# GameDay 振り返り: [日付]

## 実施シナリオ

[シナリオ名と概要]

## 結果

- 対応時間: XX分
- 成功基準: 達成 / 未達成

## 良かった点

-

## 改善点

-

## アクションアイテム

- [ ] Runbookの更新
- [ ] アラート閾値の調整
```

## 訓練記録

| 日付 | シナリオ | 対応時間 | 結果 | 担当 |
| ---- | -------- | -------- | ---- | ---- |
| -    | -        | -        | -    | -    |

## チェックリスト

### 月次訓練前

- [ ] シナリオ決定
- [ ] 参加者アサイン
- [ ] Staging環境準備
- [ ] カレンダー招待送信

### 訓練後

- [ ] 振り返りミーティング実施
- [ ] 改善点をIssue化
- [ ] Runbook更新（必要に応じて）
- [ ] 次回訓練スケジュール設定

## 改訂履歴

| 日付       | バージョン | 変更内容 |
| ---------- | ---------- | -------- |
| 2025-12-26 | v1.0       | 初版作成 |
