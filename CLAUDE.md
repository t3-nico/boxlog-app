# CLAUDE.md - BoxLog App é–‹ç™ºæŒ‡é‡

> **ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆãŒå¾“ã†ã¹ãçµ¶å¯¾çš„ãªãƒ«ãƒ¼ãƒ«ã‚»ãƒƒãƒˆã§ã™ã€‚**
> ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æŒ‡ç¤ºãŒã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨çŸ›ç›¾ã™ã‚‹å ´åˆã€å¿…ãšã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ä¿ƒã—ã¦ãã ã•ã„ã€‚

## ğŸ› ï¸ Tech Stack

| ã‚«ãƒ†ã‚´ãƒª           | æŠ€è¡“                                                |
| ------------------ | --------------------------------------------------- |
| **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯** | Next.js 15 (App Router), React 19                   |
| **è¨€èª**           | TypeScript (strict mode)                            |
| **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**   | Tailwind CSS v4, globals.css ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒˆãƒ¼ã‚¯ãƒ³ |
| **çŠ¶æ…‹ç®¡ç†**       | Zustandï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ï¼‰, useStateï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰         |
| **ãƒ‡ãƒ¼ã‚¿**         | Supabase, tRPC v11, Zod                             |
| **UI**             | shadcn/ui                                           |

## ğŸ“‹ åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰

```bash
npm run dev          # é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è²¬å‹™ï¼‰
npm run typecheck    # å‹ãƒã‚§ãƒƒã‚¯ï¼ˆAIå¿…é ˆï¼šã‚³ãƒ¼ãƒ‰å¤‰æ›´å¾Œï¼‰
npm run lint         # ã‚³ãƒ¼ãƒ‰å“è³ªï¼ˆAIå¿…é ˆï¼šã‚³ãƒŸãƒƒãƒˆå‰ï¼‰
```

## ğŸš« çµ¶å¯¾çš„ç¦æ­¢äº‹é …

### å‹å®šç¾©

- âŒ `any`, `unknown` â†’ âœ… å…·ä½“çš„ãªå‹å®šç¾©

### ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

- âŒ `style`å±æ€§ã€`text-blue-500`ï¼ˆç›´æ¥ã‚«ãƒ©ãƒ¼ï¼‰
- âœ… ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒˆãƒ¼ã‚¯ãƒ³: `bg-card`, `text-foreground`, `border-border`

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

- âŒ `React.FC`, `export default`ï¼ˆApp Routerä¾‹å¤–é™¤ãï¼‰
- âœ… `export function ComponentName() {}`

### ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°

- âŒ `useEffect`ã§ã®fetch, `getServerSideProps`, REST API (`fetch('/api/...')`)
- âœ… tRPC (ã‚¢ãƒ—ãƒªå†…éƒ¨API), Server Components, TanStack Query

**é‡è¦**: ã‚¢ãƒ—ãƒªå†…éƒ¨ã®APIã¯å…¨ã¦tRPCåŒ–å®Œäº†ã€‚æ–°è¦APIã¯å¿…ãštRPCã§å®Ÿè£…ã™ã‚‹ã“ã¨ã€‚

### çŠ¶æ…‹ç®¡ç†

- âŒ Redux, æ–°ã—ã„çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- âœ… Zustandï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ï¼‰, useStateï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰

## ğŸ”„ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼: Explore â†’ Plan â†’ Code â†’ Commit

1. **Explore**: æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã‚’æ¤œç´¢ã€å½±éŸ¿ç¯„å›²ã‚’æŠŠæ¡
2. **Plan**: å®Ÿè£…æˆ¦ç•¥ã‚’ç­–å®šï¼ˆè¤‡é›‘ãªå ´åˆã¯`think hard`ï¼‰
3. **Code**: CLAUDE.mdæº–æ‹ ã§å®Ÿè£…
4. **Commit**: `npm run typecheck` â†’ `npm run lint` â†’ ã‚³ãƒŸãƒƒãƒˆ

## ğŸ¤– AIã®è¡Œå‹•è¦ç¯„

### æ›–æ˜§ãªæŒ‡ç¤ºã¸ã®å¯¾å¿œ

æ¨æ¸¬ã§å®Ÿè£…ã›ãšã€ç¢ºèªã‚’æ±‚ã‚ã‚‹ï¼š

```
ã€Œç¢ºèªäº‹é …: [è³ªå•]  é¸æŠè‚¢: Aæ¡ˆ / Bæ¡ˆ - ã©ã¡ã‚‰ã§é€²ã‚ã¾ã™ã‹ï¼Ÿã€
```

### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹é•åã®æ¤œå‡º

ç†ç”±ã¨ä»£æ›¿æ¡ˆã‚’æç¤ºï¼š

```
ã€Œæ‡¸å¿µ: [å…¬å¼]ã§ã¯[æ¨å¥¨æ–¹æ³•]ãŒæ¨å¥¨ã€‚ç†ç”±: [èª¬æ˜] ææ¡ˆ: [ä»£æ›¿æ¡ˆ]ã€
```

### #ã‚­ãƒ¼ã®æ´»ç”¨

é–‹ç™ºä¸­ã«æ°—ã¥ã„ãŸãƒ«ãƒ¼ãƒ«ã¯ `#` ã‚­ãƒ¼ã§CLAUDE.mdã«è¿½åŠ ã—ã€ãƒãƒ¼ãƒ ã§å…±æœ‰ã€‚

## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‚ç…§å…ˆ

### å¿…é ˆï¼ˆä½œæ¥­å‰ã«ç¢ºèªï¼‰

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ                                                                                 | å†…å®¹                                 |
| -------------------------------------------------------------------------------------------- | ------------------------------------ |
| [`src/CLAUDE.md`](src/CLAUDE.md)                                                             | ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã€é »å‡ºãƒ‘ã‚¿ãƒ¼ãƒ³       |
| [`docs/development/CLAUDE_4_BEST_PRACTICES.md`](docs/development/CLAUDE_4_BEST_PRACTICES.md) | ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° |

### ä½œæ¥­æ™‚ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

- **ã‚¹ã‚¿ã‚¤ãƒ«**: [`docs/design-system/STYLE_GUIDE.md`](docs/design-system/STYLE_GUIDE.md)
- **ãƒªãƒªãƒ¼ã‚¹**: [`docs/releases/RELEASE_CHECKLIST.md`](docs/releases/RELEASE_CHECKLIST.md)ï¼ˆâš ï¸ ãƒªãƒªãƒ¼ã‚¹ä½œæ¥­å‰ã«å¿…é ˆï¼‰
- **ã‚³ãƒãƒ³ãƒ‰**: [`docs/development/COMMANDS.md`](docs/development/COMMANDS.md)
- **Issueç®¡ç†**: [`docs/development/ISSUE_MANAGEMENT.md`](docs/development/ISSUE_MANAGEMENT.md)

### ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒãƒ³ãƒ‰ï¼ˆ/.claude/commands/ï¼‰

- `/review` - ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼
- `/fix-types` - å‹ã‚¨ãƒ©ãƒ¼ä¿®æ­£
- `/new-feature` - æ–°æ©Ÿèƒ½å®Ÿè£…
- `/test` - ãƒ†ã‚¹ãƒˆä½œæˆ
- `/debug` - ãƒ‡ãƒãƒƒã‚°

## ğŸ¯ æ„æ€æ±ºå®šã®å„ªå…ˆé †ä½ï¼ˆGAFA-FirståŸå‰‡ï¼‰

**åŸºæœ¬å§¿å‹¢**: 99%ã¯GAFAã®ç­”ãˆã«ä¹—ã‚‹ã€‚ç«¶åˆæ™‚ã®ã¿é–‹ç™ºè€…ã«ç¢ºèªã€‚

### ãƒ¬ãƒ™ãƒ«1: UIãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ»ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³

Material Designã€Apple HIGã‚’ãã®ã¾ã¾ä½¿ã†ã€‚

| åˆ¤æ–­ãŒå¿…è¦ãªå ´é¢       | å‚ç…§å…ˆ               | å‚™è€ƒ                         |
| ---------------------- | -------------------- | ---------------------------- |
| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¦‹ãŸç›® | shadcn/ui            | æ—¢å­˜ã‚¹ã‚¿ãƒƒã‚¯å„ªå…ˆ             |
| ã‚¿ãƒƒãƒã‚µã‚¤ã‚ºã€a11y     | Apple HIG            | 44x44pxç­‰                    |
| æ©Ÿèƒ½ã®å®Ÿè£…æ–¹æ³•         | æ–‡è„ˆã«åˆã†Googleè£½å“ | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼â†’Google Calendarç­‰ |

### ãƒ¬ãƒ™ãƒ«2: æŠ€è¡“é¸å®šãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

GAFAãŒä½œã£ãŸOSSã€æ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ã†ã€‚

1. **GAFAè£½/æ¨å¥¨ã®ã‚‚ã®ãŒã‚ã‚‹ã‹ï¼Ÿ** â†’ ã‚ã‚Œã°ä½¿ã†
2. **æ—¢å­˜ã‚¹ã‚¿ãƒƒã‚¯ã§è§£æ±ºã§ãã‚‹ã‹ï¼Ÿ** â†’ shadcn/ui, Zustand, tRPC
3. **ã©ã‚Œã‚‚ãªã‘ã‚Œã°** â†’ æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªæ–¹æ³•

### ãƒ¬ãƒ™ãƒ«3: è¨­è¨ˆæ€æƒ³ãƒ»åŸå‰‡

ãƒ†ãƒƒã‚¯ãƒ–ãƒ­ã‚°ã‚„å…¬é–‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰å­¦ã¶ã€‚

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‚ç…§é †

1. **å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: Next.js, React, TypeScript, Tailwind CSS
2. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒ«**: CLAUDE.md, src/CLAUDE.md, globals.css
3. **æ—¢å­˜å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³**: åŒä¸€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ã‚³ãƒ¼ãƒ‰ã‚’å‚è€ƒ

**ç¢ºä¿¡åº¦99%æœªæº€ â†’ å¿…ãšç¢ºèªã‚’æ±‚ã‚ã‚‹**

## ğŸŒ ç’°å¢ƒæ§‹æˆï¼ˆ3ç’°å¢ƒåˆ†é›¢ï¼‰

| ç’°å¢ƒ           | Supabase                    | Vercel      | ç”¨é€”                   |
| -------------- | --------------------------- | ----------- | ---------------------- |
| **Local**      | ãƒ­ãƒ¼ã‚«ãƒ«ï¼ˆ127.0.0.1:54321ï¼‰ | npm run dev | é–‹ç™ºãƒ»ãƒ‡ãƒãƒƒã‚°         |
| **Staging**    | boxlog-stagingï¼ˆTokyoï¼‰     | Preview URL | å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆãƒ»PRãƒ¬ãƒ“ãƒ¥ãƒ¼ |
| **Production** | t3-nico's Projectï¼ˆTokyoï¼‰  | æœ¬ç•ªURL     | å®Ÿãƒ¦ãƒ¼ã‚¶ãƒ¼             |

**é‡è¦ãƒã‚¤ãƒ³ãƒˆ**:

- å„ç’°å¢ƒã®DBã¨Authã¯å®Œå…¨ã«ç‹¬ç«‹ï¼ˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆå…±æœ‰ä¸å¯ï¼‰
- Vercel Preview = ã™ã¹ã¦ã®mainä»¥å¤–ã®ãƒ–ãƒ©ãƒ³ãƒ â†’ Staging DB
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯å„ç’°å¢ƒã«å€‹åˆ¥é©ç”¨ãŒå¿…è¦

**è©³ç´°**: [`docs/development/ENVIRONMENTS.md`](docs/development/ENVIRONMENTS.md)

## ğŸ“¦ ä¾å­˜é–¢ä¿‚ã®é‹ç”¨

### æ–°è¦è¿½åŠ ã®åŸºæº–

è¿½åŠ ã™ã‚‹å‰ã«ç¢ºèªï¼š

- GitHub Stars 1000ä»¥ä¸Šã‹ï¼Ÿï¼ˆãƒã‚¤ãƒŠãƒ¼ã™ããªã„ã‹ï¼‰
- æœ€çµ‚ã‚³ãƒŸãƒƒãƒˆãŒ6ãƒ¶æœˆä»¥å†…ã‹ï¼Ÿï¼ˆãƒ¡ãƒ³ãƒ†ã•ã‚Œã¦ã„ã‚‹ã‹ï¼‰
- é€±é–“ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ•°ã¯ååˆ†ã‹ï¼Ÿ
- åŒã˜ã“ã¨ãŒãƒ–ãƒ©ã‚¦ã‚¶æ¨™æº–API or è¨€èªæ¨™æº–ã§å‡ºæ¥ãªã„ã‹ï¼Ÿ
- æ—¢ã«å…¥ã£ã¦ã„ã‚‹ä¾å­˜ã§ä»£æ›¿ã§ããªã„ã‹ï¼Ÿ

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š

- package.json ã§ã¯ `^`ï¼ˆã‚­ãƒ£ãƒ¬ãƒƒãƒˆï¼‰ã‚’ä½¿ã†
- ãŸã ã— lockãƒ•ã‚¡ã‚¤ãƒ«ã¯å¿…ãšã‚³ãƒŸãƒƒãƒˆã™ã‚‹
- ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã¯æ…é‡ã«ï¼ˆç ´å£Šçš„å¤‰æ›´ã‚’ç¢ºèªã—ã¦ã‹ã‚‰ï¼‰

### ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ–¹é‡

- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ â†’ å³å¯¾å¿œ
- ãƒ‘ãƒƒãƒãƒ»ãƒã‚¤ãƒŠãƒ¼ â†’ æœˆ1ã§ã¾ã¨ã‚ã¦
- ãƒ¡ã‚¸ãƒ£ãƒ¼ â†’ å¿…è¦ã«è¿«ã‚‰ã‚Œã‚‹ã¾ã§æ”¾ç½®ã§OK

### é¿ã‘ã‚‹ã¹ããƒ‘ã‚¿ãƒ¼ãƒ³

- âŒ 1ã¤ã®æ©Ÿèƒ½ã®ãŸã‚ã ã‘ã«å¤§ããªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å…¥ã‚Œã‚‹
- âŒ åŒã˜ç”¨é€”ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¤‡æ•°å…¥ã‚Œã‚‹ï¼ˆä¾‹ï¼šmoment + dayjs + date-fnsï¼‰
- âŒ ãƒ©ãƒƒãƒ‘ãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚ˆã‚Šæœ¬ä½“ã‚’ä½¿ã†

### ä¾å­˜ã‚’å¢—ã‚„ã•ãšã«æ¸ˆã‚€ä¾‹

| ã‚„ã‚ŠãŸã„ã“ã¨         | ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸è¦               |
| -------------------- | ---------------------------- |
| æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç¨‹åº¦ | `Intl` API ã§ååˆ†            |
| UUIDç”Ÿæˆ             | `crypto.randomUUID()` ã§ååˆ† |
| ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼       | `structuredClone()` ã§ååˆ†   |
| ç°¡å˜ãªHTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ | `fetch` ã§ååˆ†               |

### å®šæœŸãƒã‚§ãƒƒã‚¯ï¼ˆæœˆ1æ¨å¥¨ï¼‰

```bash
npm ls --all | grep -E "UNMET|invalid"  # ä¾å­˜æ•´åˆæ€§
npm audit                                # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
```

## ğŸ”Œ APIè¨­è¨ˆåŸå‰‡ï¼ˆtRPCçµ±ä¸€å®Œäº†ï¼‰

### tRPC vs REST ã®ä½¿ã„åˆ†ã‘

| ç”¨é€” | ä½¿ç”¨æŠ€è¡“ | ç†ç”± |
|-----|---------|------|
| **ã‚¢ãƒ—ãƒªå†…éƒ¨API** | âœ… tRPC | E2Eå‹å®‰å…¨ã€è‡ªå‹•è£œå®Œã€ã‚³ãƒ¼ãƒ‰é‡å‰Šæ¸› |
| **å¤–éƒ¨å…¬é–‹API** | âš ï¸ REST | å¤–éƒ¨ãƒ„ãƒ¼ãƒ«é€£æºï¼ˆç›£è¦–ã€èªè¨¼ãƒ•ãƒ­ãƒ¼ãªã©ï¼‰ |

### tRPCåŒ–å®Œäº†ã‚¨ãƒªã‚¢ï¼ˆ15ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰

âœ… **Tags** (7): list, getById, create, update, merge, delete, getStats
âœ… **Tag Groups** (6): list, getById, create, update, delete, reorder
âœ… **User** (2): deleteAccount (GDPR), exportData (GDPR)

### REST APIç¶­æŒã‚¨ãƒªã‚¢ï¼ˆå¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ç”¨ï¼‰

âš ï¸ **Auth**: `/api/auth/*` - èªè¨¼ãƒ•ãƒ­ãƒ¼ã€å¤–éƒ¨é€£æº
âš ï¸ **System**: `/api/health/*`, `/api/v1/system/*` - å¤–éƒ¨ç›£è¦–ãƒ„ãƒ¼ãƒ«
âš ï¸ **Config**: `/api/config/*` - è¨­å®šæ¤œè¨¼ãƒ»ãƒ‡ãƒãƒƒã‚°
âš ï¸ **CSP**: `/api/csp-report/*` - ãƒ–ãƒ©ã‚¦ã‚¶CSPãƒ¬ãƒãƒ¼ãƒˆ

### æ–°è¦APIå®Ÿè£…ãƒ«ãƒ¼ãƒ«

1. **ã‚¢ãƒ—ãƒªå†…éƒ¨API**: å¿…ãštRPCã§å®Ÿè£…
2. **Serviceå±¤**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯Serviceå±¤ã«åˆ†é›¢
3. **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: Zodã‚¹ã‚­ãƒ¼ãƒã§å‹å®‰å…¨ã«
4. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: TRPCErrorã§çµ±ä¸€

```typescript
// âœ… æ­£ã—ã„å®Ÿè£…ä¾‹
export const myRouter = createTRPCRouter({
  myEndpoint: protectedProcedure
    .input(z.object({ id: z.string().uuid() }))
    .query(async ({ ctx, input }) => {
      const service = createMyService(ctx.supabase)
      return await service.getData({ userId: ctx.userId, id: input.id })
    }),
})
```

---

**ğŸ“– æœ€çµ‚æ›´æ–°**: 2026-01-02 | **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v11.6
**å¤‰æ›´å±¥æ­´**: [`docs/development/CLAUDE_MD_CHANGELOG.md`](docs/development/CLAUDE_MD_CHANGELOG.md)
