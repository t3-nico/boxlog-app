import { Meta } from '@storybook/blocks';

<Meta title="Docs/Accessibility/フォームとDialog" />

# フォームとDialog

フォーム要素のラベル紐付け、エラー状態、Dialog の必須ルール

---

## Label と Input の紐付け

必ず `htmlFor` と `id` を使って紐付ける。

```tsx
<Label htmlFor="email">メールアドレス</Label>
<Input
  id="email"
  type="email"
  aria-describedby="email-hint"
/>
<p id="email-hint" className="text-sm text-muted-foreground">
  確認メールを送信します
</p>
```

---

## エラー状態

`aria-invalid` と `aria-describedby` でエラーを関連付け。

```tsx
<Input
  id="email"
  aria-invalid={!!error}
  aria-describedby={error ? "email-error" : undefined}
/>
{error && (
  <p id="email-error" role="alert" className="text-destructive">
    {error}
  </p>
)}
```

---

## ローディング状態

`aria-busy` でローディング中であることを伝える。

```tsx
<Button disabled aria-busy={isLoading}>
  {isLoading ? <Spinner /> : '保存'}
</Button>
```

---

## Dialog / AlertDialog

shadcn/ui（Radix UI）の Dialog/AlertDialog は基本的なa11y対応済み。ただし、必須ルールがある。

### DialogTitle / DialogDescription を省略しない

省略するとスクリーンリーダーで内容が伝わらない。`aria-labelledby` と `aria-describedby` が自動設定される。

```tsx
// ✅ 良い例
<DialogContent>
  <DialogHeader>
    <DialogTitle>設定</DialogTitle>
    <DialogDescription>
      アプリの設定を変更します
    </DialogDescription>
  </DialogHeader>
  {/* コンテンツ */}
</DialogContent>

// ❌ 悪い例（DialogTitle/Description なし）
<DialogContent>
  <h2>設定</h2>
  <p>アプリの設定を変更します</p>
</DialogContent>
```

### 視覚的に非表示にする場合

デザイン上タイトルを表示したくない場合も、`sr-only` で残す。

```tsx
<DialogHeader>
  <DialogTitle className="sr-only">
    画像プレビュー
  </DialogTitle>
</DialogHeader>
```
