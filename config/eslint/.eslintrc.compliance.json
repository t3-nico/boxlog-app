{
  "extends": [
    "./config/eslint/.eslintrc.json",
    "plugin:jsx-a11y/recommended",
    "plugin:security/recommended"
  ],
  "plugins": [
    "jsx-a11y",
    "security",
    "boxlog-compliance"
  ],
  "rules": {
    // 🔴 WCAG 2.1 Level AA - 必須ルール
    "jsx-a11y/alt-text": "error",
    "jsx-a11y/anchor-has-content": "error", 
    "jsx-a11y/anchor-is-valid": "error",
    "jsx-a11y/aria-activedescendant-has-tabindex": "error",
    "jsx-a11y/aria-props": "error",
    "jsx-a11y/aria-proptypes": "error",
    "jsx-a11y/aria-role": "error",
    "jsx-a11y/aria-unsupported-elements": "error",
    "jsx-a11y/autocomplete-valid": "error",
    "jsx-a11y/click-events-have-key-events": "error",
    "jsx-a11y/control-has-associated-label": "error",
    "jsx-a11y/heading-has-content": "error",
    "jsx-a11y/html-has-lang": "error",
    "jsx-a11y/iframe-has-title": "error",
    "jsx-a11y/img-redundant-alt": "error",
    "jsx-a11y/interactive-supports-focus": "error",
    "jsx-a11y/label-has-associated-control": ["error", {
      "labelComponents": ["Label"],
      "labelAttributes": ["label"],
      "controlComponents": ["Input", "Textarea", "Select"],
      "assert": "either",
      "depth": 3
    }],
    "jsx-a11y/lang": "error",
    "jsx-a11y/media-has-caption": "error",
    "jsx-a11y/mouse-events-have-key-events": "error",
    "jsx-a11y/no-access-key": "error",
    "jsx-a11y/no-aria-hidden-on-focusable": "error",
    "jsx-a11y/no-autofocus": "error",
    "jsx-a11y/no-distracting-elements": "error",
    "jsx-a11y/no-interactive-element-to-noninteractive-role": "error",
    "jsx-a11y/no-noninteractive-element-interactions": "error",
    "jsx-a11y/no-noninteractive-element-to-interactive-role": "error",
    "jsx-a11y/no-noninteractive-tabindex": "error",
    "jsx-a11y/no-redundant-roles": "error",
    "jsx-a11y/no-static-element-interactions": "error",
    "jsx-a11y/role-has-required-aria-props": "error",
    "jsx-a11y/role-supports-aria-props": "error",
    "jsx-a11y/scope": "error",
    "jsx-a11y/tabindex-no-positive": "error",

    // 🔴 SOC 2 Security - 必須ルール  
    "security/detect-buffer-noassert": "error",
    "security/detect-child-process": "error",
    "security/detect-disable-mustache-escape": "error",
    "security/detect-eval-with-expression": "error",
    "security/detect-new-buffer": "error",
    "security/detect-no-csrf-before-method-override": "error",
    "security/detect-non-literal-fs-filename": "error",
    "security/detect-non-literal-regexp": "error",
    "security/detect-non-literal-require": "error",
    "security/detect-object-injection": "error",
    "security/detect-possible-timing-attacks": "error",
    "security/detect-pseudoRandomBytes": "error",
    "security/detect-unsafe-regex": "error",

    // 🔴 GDPR/Privacy - カスタムルール (後で実装)
    "boxlog-compliance/no-personal-data-logging": "error",
    "boxlog-compliance/require-consent-tracking": "error",
    "boxlog-compliance/data-retention-policy": "error",
    "boxlog-compliance/secure-data-transmission": "error",
    "boxlog-compliance/no-third-party-tracking": "error",

    // 🟡 Enhanced Security - 重要ルール
    "no-eval": "error",
    "no-implied-eval": "error", 
    "no-new-func": "error",
    "no-script-url": "error",
    "prefer-const": "error",
    "no-var": "error",
    "no-debugger": "error",
    "no-console": ["warn", { "allow": ["warn", "error"] }]
  },
  "overrides": [
    {
      "files": ["src/pages/**/*.tsx", "src/app/**/*.tsx"],
      "rules": {
        // Next.js pages require specific WCAG compliance
        "jsx-a11y/html-has-lang": "error",
        "jsx-a11y/lang": "error"
      }
    },
    {
      "files": ["src/components/ui/**/*.tsx"],
      "rules": {
        // UI components require strict accessibility
        "jsx-a11y/label-has-associated-control": "error",
        "jsx-a11y/control-has-associated-label": "error"
      }
    },
    {
      "files": ["src/features/**/*.tsx"],
      "rules": {
        // Feature components require privacy compliance
        "boxlog-compliance/no-personal-data-logging": "error",
        "boxlog-compliance/require-consent-tracking": "warn"
      }
    }
  ],
  "settings": {
    "jsx-a11y": {
      "polymorphicPropName": "as",
      "components": {
        "Button": "button",
        "Input": "input",
        "Textarea": "textarea",
        "Select": "select",
        "Link": "a",
        "Image": "img"
      }
    }
  }
}