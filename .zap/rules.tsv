# OWASP ZAP Scan Rules
# Format: RULE_ID	ACTION	DESCRIPTION
#
# Actions:
#   IGNORE  - ルールを無視（誤検出の場合）
#   WARN    - 警告として報告
#   FAIL    - エラーとして報告（CI失敗）
#
# @see https://www.zaproxy.org/docs/alerts/
# @see Issue #487 - OWASP準拠のセキュリティ強化

# ==================================================
# Phase 1: Report-Only期間中は警告のみ
# ==================================================

# CSP Report-Onlyモード（Phase 1では許可）
10038	IGNORE	Content Security Policy (CSP) Header Not Set
10055	IGNORE	CSP: Wildcard Directive
10056	IGNORE	CSP: script-src unsafe-inline
10057	IGNORE	CSP: script-src unsafe-eval

# Next.js Server Actionsによる自動CSRF保護
10202	IGNORE	Absence of Anti-CSRF Tokens

# Vercel自動設定（本番環境）
10023	IGNORE	Information Disclosure - Debug Error Messages (開発環境のみ)

# ==================================================
# Phase 2以降で対応予定
# ==================================================

# Cookie設定（Supabase管理）
10054	WARN	Cookie Without SameSite Attribute
10010	WARN	Cookie No HttpOnly Flag
10011	WARN	Cookie Without Secure Flag

# ==================================================
# 重大な脆弱性は常にエラー
# ==================================================

# SQLインジェクション（Supabase ORMで保護済み）
40018	FAIL	SQL Injection

# XSS（DOMPurifyで保護済み）
40012	FAIL	Cross Site Scripting (Reflected)
40014	FAIL	Cross Site Scripting (Persistent)
40016	FAIL	Cross Site Scripting (DOM Based)
40017	FAIL	Source Code Disclosure

# 認証・セッション管理
10105	FAIL	Weak Authentication Method
10101	FAIL	Insecure HTTP Method

# 機密情報漏洩
10096	FAIL	Timestamp Disclosure
10097	FAIL	Hash Disclosure
10098	FAIL	Cross-Domain Misconfiguration
